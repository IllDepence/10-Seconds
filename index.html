<!DOCTYPE HTML>

<!-- - - - - - - - - - - - - - - - - <html> - - - - - - - - - - - - - - - - -->
<html>

<!-- - - - - - - - - - - - - - - - - <head> - - - - - - - - - - - - - - - - -->
<head>
<title>10 Seconds</title>

<link rel="SHORTCUT ICON" href="favicon.ico" />
<link rel="stylesheet" type="text/css" href="style.css" />
<meta charset="utf-8" />

<!-- - - - - - - - - - - - - - - - - <style> - - - - - - - - - - - - - - - - -->
<style type="text/css">
* {
margin: 0;
padding: 0;
}
#gameField {
background-color: #f0f0f0;
position: absolute;
top: 10px;
left: 10px;
}
.entity {
position: absolute;
}
#debug {
position: absolute;
top: 20px;
left: 800px;
}
</style>
<!-- - - - - - - - - - - - - - - - - </style> - - - - - - - - - - - - - - - - -->

</head>
<!-- - - - - - - - - - - - - - - - - </head> - - - - - - - - - - - - - - - - -->


<!-- - - - - - - - - - - - - - - - - <body> - - - - - - - - - - - - - - - - -->
<body>

</body>
<!-- - - - - - - - - - - - - - - - - </body> - - - - - - - - - - - - - - - - -->
<div id="gameField"></div>
<div id="debug"></div>
<script>
/* - - - - - - - [Class] Entity - - - - - - - */
function Entity() {}
Entity.prototype.setX = function(x) {
	this.node.style.left = x+'px';
	}
Entity.prototype.setY = function(y) {
	this.node.style.top = y+'px';
	}
Entity.prototype.init = function(x, y, nd, fld, wi, he, sld) {
	this.field = fld;
	prt = fld.node;
	if(prt instanceof HTMLElement) {
		this.node = nd;
		this.parentNode = prt;
		this.node.className = 'entity';
		this.setX(x);
		this.setY(y);
		this.parentNode.appendChild(this.node);
		this.width = wi;
		this.height = he;
		this.solid = sld;
		this.xSpeed = 0; // change of x in one tick
		this.ySpeed = 0; //     "     y     "
		}
	}
Entity.prototype.getX = function() {
	return this.node.style.left.substr(0, this.node.style.left.length-2);
	}
Entity.prototype.getY = function() {
	return this.node.style.top.substr(0, this.node.style.top.length-2);
	}
Entity.prototype.accX = function(d) {
	this.xSpeed = this.xSpeed+d;
	}
Entity.prototype.accY = function(d) {
	this.ySpeed = this.ySpeed+d;
	}
Entity.prototype.decel = function() {
	this.xSpeed = this.xSpeed+(this.xSpeed==0 ? 0 : (this.xSpeed>0 ? -1 : 1));
	}
Entity.prototype.tick = function() {
	//document.getElementById('debug').innerHTML = this.xSpeed + ' | ' + this.ySpeed;
	var nextX = parseInt(this.getX()) + parseInt(this.xSpeed);
	var nextY = parseInt(this.getY()) + parseInt(this.ySpeed);
	if(nextX>=0 && (nextX+this.width)<this.field.width) {
		this.setX(nextX);
		}
	else {
		this.xSpeed = 0;
		this.setX(nextX<0 ? 0 : this.field.width-this.width);
		}
	if(nextY>=0 && (nextY+this.height)<this.field.height) {
		this.setY(nextY);
		}
	else {
		this.ySpeed = 0;
		this.setY(nextY<0 ? 0 : this.field.height-this.height);
		}
	}
/* - - - - - - - [Class] Player - - - - - - - */
Player.prototype = new Entity();
Player.prototype.constructor = Player;
function Player(fld) {
	var nd = document.createElement('img');
	nd.src = 'bb.png';
	this.init(0, 0, nd, fld, 10, 10, true);
	this.jumplock = 0;
	}
Player.prototype.jump = function() {
	if(this.ySpeed == 0 && this.jumplock==0) this.accY(-15);
	this.jumplock = 1;
	}
/* - - - - - - - [Class] gameField - - - - - - - */
function GameField() {}
GameField.prototype.init = function(w, h, nd) {
	this.node = nd;
	this.width = w;
	this.height = h;
	if(this.node instanceof HTMLElement) {
		this.node.style.width = w+'px';
		this.node.style.height = h+'px';
		}
	}
/* - - - - - - - [Class] Game - - - - - - - */
function Game() {
	this.field = new GameField();
	this.field.init(700, 400, document.getElementById('gameField'));
	this.entities = [];
	var plyr = new Player(this.field);
	this.player = plyr;
	this.entities.push(plyr);
	this.currKeyCode = -1;
	this.gravity = 1;
	this.ticks = 0;
	}
Game.prototype.tick = function() {
	this.ticks++;
	switch(game.currKeyCode) {
		case 32: //space bar
			game.player.jump();
			break;
		case 37: //left
			game.player.accX(-1);
			break;
		case 38: //up
			game.player.jump();
			break;
		case 39: //right
			game.player.accX(1);
			break;
		case 40: //down
			//game.player.accY(1);
			break;
		case -1:
			game.player.decel();
			game.player.jumplock = 0;
			break;
		}
	for(var i=0; i<this.entities.length; i++) {
		var e = this.entities[i];
		if((parseInt(e.getY())+parseInt(e.height))<this.field.height)
			e.accY(this.gravity);
		e.tick();
		}
	}

// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
var game = new Game();
//var gameInfo = document.getElementById('gameInfo');
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

document.onkeydown = function(e) {
	var keyCode = (window.event) ? event.keyCode : e.keyCode;
	game.currKeyCode = keyCode;
	}

document.onkeyup = function(e) {
	var keyCode = (window.event) ? event.keyCode : e.keyCode;
	game.currKeyCode = -1;
	}

// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

var fps = 60;
function draw() {
	setTimeout(function() {
		requestAnimationFrame(draw);
		//game logic
		}, 1000 / fps);
		game.tick();
	}
draw();

</script>

</html>
<!-- - - - - - - - - - - - - - - - - </html> - - - - - - - - - - - - - - - - -->
